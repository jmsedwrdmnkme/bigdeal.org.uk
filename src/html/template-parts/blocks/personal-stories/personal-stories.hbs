<?php
/**
 * Personal stories block
 *
 * @package      Synthetic
 * @author       James Monk
 * @since        1.0.0
 * @license      GPL-2.0+
**/

$title = get_field('title');
$button_text = get_field('button_text');
$button_link = get_field('button_link');

// disable block frontend wrapper.
add_filter( 'acf/hero/frontend_allow_wrapper', '__return_false' );
?>
<div class="wp-block-group bg-green-offset">
  <div class="wp-block-group__inner-container">
    <h2 class="has-text-align-center"><?php echo $title; ?></h2>
    <div class="wp-block-columns">
      <?php 
        $args = array( 
        'orderby' => 'ASC',
        'posts_per_page' => 2,
        'post_type' => 'personal_stories',
        );
        $the_query = new WP_Query( $args );
        $count = 0;

        if ( $the_query->have_posts() ) : while ( $the_query->have_posts() ) : $the_query->the_post();
          $count++; ?>
          <div class="personal-stories-post wp-block-column card block-heading <?php if($count == 1) : echo "red"; else : echo "blue"; endif; ?>">
            <h3 class="display-2"><?php the_title(); ?></h3>
            <p><?php the_excerpt(); ?></p>
            <p><a href="<?php the_permalink(); ?>" data-type="page" data-id="28">Read <?php the_title(); ?></a></p>
          </div>
        <?php endwhile; endif; ?>
     <?php wp_reset_query(); ?>
    </div>
    <div class="wp-block-buttons is-content-justification-center">
      <div class="wp-block-button is-style-fill">
        <a class="wp-block-button__link" href="<?php echo $button_link; ?>"><?php echo $button_text; ?></a></div>
      </div>
    </div>
  </div>
</div>
